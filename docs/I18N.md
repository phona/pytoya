# Internationalization (i18n)

This repo supports UI localization in the web app (`src/apps/web`).

## Supported locales

- `en` (default)
- `zh-CN`

## Web i18n architecture

- A single `I18nProvider` exposes:
  - `locale`
  - `setLocale(locale)`
  - `t(key, vars?)`
- Catalogs are stored in-repo and loaded by locale.
- Locale resolution order:
  1) user preference in `localStorage`
  2) browser language (`navigator.language`)
  3) fallback `en`

## Key conventions

Use stable, namespaced keys (do not use English-as-key).

Examples:
- `common.save`
- `nav.projects`
- `auth.login.title`
- `errors.PROJECT_NOT_FOUND`
- `errors.generic`

## Interpolation

Use `{{name}}` placeholders in message strings and pass `vars` to `t()`:

- Message: `"Request failed ({{requestId}})"`
- Call: `t('errors.withRequestId', { requestId })`

## Backend errors (client-side localization)

The API returns a consistent error envelope:
```json
{ "error": { "code": "...", "requestId": "..." } }
```

The web app SHOULD map backend `error.code` to translation keys (with a safe fallback) and MAY show `requestId` to help support/debugging.

## Manual QA checklist

- Switch language in the sidebar and confirm it persists after refresh.
- Confirm `<html lang>` updates to the selected locale.
- Trigger a known backend error and verify:
  - the message is localized from `error.code`
  - `requestId` is shown when provided
- Trigger an unknown backend `error.code` and verify a localized generic error message is shown.
- Temporarily remove a translation key and verify fallback behavior is safe (no blank UI).
